#include <nanoarrow/nanoarrow.hpp>
#include <nanoarrow/nanoarrow.h>
#include <nanoarrow/nanoarrow_ipc.hpp>
#include <nanoarrow/nanoarrow_ipc.h>

#define ARROW_ERROR_PRINT(EXPR) \
do {                                            \
  const int code = (EXPR);                                                            \
  if (code) printf("Nanoarror error: %s: %s\n", #EXPR, error.message);                           \
} while (0)

namespace na = nanoarrow;

na::UniqueSchema make_nanoarrow_schema() {
    na::UniqueSchema schema_root;
    ArrowSchemaInit(schema_root.get());
    ArrowSchemaSetName(schema_root.get(), "Root");
    ArrowSchemaSetTypeStruct(schema_root.get(), 222);

    ArrowSchemaInitFromType(schema_root->children[0], NANOARROW_TYPE_INT16);
    ArrowSchemaSetName(schema_root->children[0], "SME_THROTL_TorqueDemand");
    ArrowSchemaInitFromType(schema_root->children[1], NANOARROW_TYPE_INT16);
    ArrowSchemaSetName(schema_root->children[1], "SME_THROTL_MaxSpeed");
    ArrowSchemaInitFromType(schema_root->children[2], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[2], "SME_THROTL_Forward");
    ArrowSchemaInitFromType(schema_root->children[3], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[3], "SME_THROTL_Reverse");
    ArrowSchemaInitFromType(schema_root->children[4], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[4], "SME_THROTL_UNUSED_BIT_1");
    ArrowSchemaInitFromType(schema_root->children[5], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[5], "SME_THROTL_PowerReady");
    ArrowSchemaInitFromType(schema_root->children[6], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[6], "SME_THROTL_UNUSED_BIT_2");
    ArrowSchemaInitFromType(schema_root->children[7], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[7], "SME_THROTL_UNUSED_BIT_3");
    ArrowSchemaInitFromType(schema_root->children[8], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[8], "SME_THROTL_UNUSED_BIT_4");
    ArrowSchemaInitFromType(schema_root->children[9], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[9], "SME_THROTL_UNUSED_BIT_5");
    ArrowSchemaInitFromType(schema_root->children[10], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[10], "SME_THROTL_MBB_Alive");
    ArrowSchemaInitFromType(schema_root->children[11], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[11], "SME_THROTL_UNUSED_BIT_6");
    ArrowSchemaInitFromType(schema_root->children[12], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[12], "SME_THROTL_UNUSED_BIT_7");
    ArrowSchemaInitFromType(schema_root->children[13], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[13], "SME_THROTL_UNUSED_BIT_8");
    ArrowSchemaInitFromType(schema_root->children[14], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[14], "SME_THROTL_UNUSED_BIT_9");
    ArrowSchemaInitFromType(schema_root->children[15], NANOARROW_TYPE_UINT16);
    ArrowSchemaSetName(schema_root->children[15], "SME_THROTL_UNUSED_SHORT_1");
    ArrowSchemaInitFromType(schema_root->children[16], NANOARROW_TYPE_UINT16);
    ArrowSchemaSetName(schema_root->children[16], "SME_CURRLIM_ChargeCurrentLim");
    ArrowSchemaInitFromType(schema_root->children[17], NANOARROW_TYPE_UINT16);
    ArrowSchemaSetName(schema_root->children[17], "SME_CURRLIM_DischargeCurrentLim");
    ArrowSchemaInitFromType(schema_root->children[18], NANOARROW_TYPE_UINT32);
    ArrowSchemaSetName(schema_root->children[18], "SME_CURRLIM_UNUSED_INT_1");
    ArrowSchemaInitFromType(schema_root->children[19], NANOARROW_TYPE_UINT16);
    ArrowSchemaSetName(schema_root->children[19], "SME_TRQSPD_Speed");
    ArrowSchemaInitFromType(schema_root->children[20], NANOARROW_TYPE_INT16);
    ArrowSchemaSetName(schema_root->children[20], "SME_TRQSPD_Torque");
    ArrowSchemaInitFromType(schema_root->children[21], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[21], "SME_TRQSPD_SOC_Low_Traction");
    ArrowSchemaInitFromType(schema_root->children[22], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[22], "SME_TRQSPD_SOC_Low_Hydraulic");
    ArrowSchemaInitFromType(schema_root->children[23], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[23], "SME_TRQSPD_Reverse");
    ArrowSchemaInitFromType(schema_root->children[24], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[24], "SME_TRQSPD_Forward");
    ArrowSchemaInitFromType(schema_root->children[25], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[25], "SME_TRQSPD_Park_Brake");
    ArrowSchemaInitFromType(schema_root->children[26], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[26], "SME_TRQSPD_Pedal_Brake");
    ArrowSchemaInitFromType(schema_root->children[27], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[27], "SME_TRQSPD_Controller_Overtermp");
    ArrowSchemaInitFromType(schema_root->children[28], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[28], "SME_TRQSPD_Key_switch_overvolt");
    ArrowSchemaInitFromType(schema_root->children[29], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[29], "SME_TRQSPD_Key_switch_undervolt");
    ArrowSchemaInitFromType(schema_root->children[30], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[30], "SME_TRQSPD_Running");
    ArrowSchemaInitFromType(schema_root->children[31], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[31], "SME_TRQSPD_Traction");
    ArrowSchemaInitFromType(schema_root->children[32], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[32], "SME_TRQSPD_Hydraulic");
    ArrowSchemaInitFromType(schema_root->children[33], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[33], "SME_TRQSPD_Powering_Enabled");
    ArrowSchemaInitFromType(schema_root->children[34], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[34], "SME_TRQSPD_Powering_Ready");
    ArrowSchemaInitFromType(schema_root->children[35], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[35], "SME_TRQSPD_Precharging");
    ArrowSchemaInitFromType(schema_root->children[36], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[36], "SME_TRQSPD_contactor_closed");
    ArrowSchemaInitFromType(schema_root->children[37], NANOARROW_TYPE_UINT16);
    ArrowSchemaSetName(schema_root->children[37], "SME_TRQSPD_MotorFlags");
    ArrowSchemaInitFromType(schema_root->children[38], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[38], "SME_TEMP_MotorTemperature");
    ArrowSchemaInitFromType(schema_root->children[39], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[39], "SME_TEMP_ControllerTemperature");
    ArrowSchemaInitFromType(schema_root->children[40], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[40], "SME_TEMP_DC_Bus_V");
    ArrowSchemaInitFromType(schema_root->children[41], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[41], "SME_TEMP_FaultCode");
    ArrowSchemaInitFromType(schema_root->children[42], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[42], "SME_TEMP_FaultLevel");
    ArrowSchemaInitFromType(schema_root->children[43], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[43], "SME_TEMP_BusCurrent");
    ArrowSchemaInitFromType(schema_root->children[44], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[44], "ACC_STATUS_BMS_FAULT");
    ArrowSchemaInitFromType(schema_root->children[45], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[45], "ACC_STATUS_IMD_FAULT");
    ArrowSchemaInitFromType(schema_root->children[46], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[46], "ACC_STATUS_SHUTDOWN_STATE");
    ArrowSchemaInitFromType(schema_root->children[47], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[47], "ACC_STATUS_PRECHARGE_DONE");
    ArrowSchemaInitFromType(schema_root->children[48], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[48], "ACC_STATUS_PRECHARING");
    ArrowSchemaInitFromType(schema_root->children[49], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[49], "ACC_STATUS_CELL_TOO_LOW");
    ArrowSchemaInitFromType(schema_root->children[50], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[50], "ACC_STATUS_CELL_TOO_HIGH");
    ArrowSchemaInitFromType(schema_root->children[51], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[51], "ACC_STATUS_TEMP_TOO_LOW");
    ArrowSchemaInitFromType(schema_root->children[52], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[52], "ACC_STATUS_TEMP_TOO_HIGH");
    ArrowSchemaInitFromType(schema_root->children[53], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[53], "ACC_POWER_PACK_VOLTAGE");
    ArrowSchemaInitFromType(schema_root->children[54], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[54], "ACC_POWER_SOC");
    ArrowSchemaInitFromType(schema_root->children[55], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[55], "ACC_POWER_CURRENT");
    ArrowSchemaInitFromType(schema_root->children[56], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[56], "ACC_SEG0_VOLTS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[57], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[57], "ACC_SEG0_VOLTS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[58], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[58], "ACC_SEG0_VOLTS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[59], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[59], "ACC_SEG0_VOLTS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[60], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[60], "ACC_SEG0_VOLTS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[61], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[61], "ACC_SEG0_VOLTS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[62], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[62], "ACC_SEG0_TEMPS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[63], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[63], "ACC_SEG0_TEMPS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[64], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[64], "ACC_SEG0_TEMPS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[65], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[65], "ACC_SEG0_TEMPS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[66], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[66], "ACC_SEG0_TEMPS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[67], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[67], "ACC_SEG0_TEMPS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[68], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[68], "ACC_SEG1_VOLTS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[69], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[69], "ACC_SEG1_VOLTS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[70], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[70], "ACC_SEG1_VOLTS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[71], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[71], "ACC_SEG1_VOLTS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[72], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[72], "ACC_SEG1_VOLTS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[73], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[73], "ACC_SEG1_VOLTS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[74], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[74], "ACC_SEG1_TEMPS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[75], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[75], "ACC_SEG1_TEMPS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[76], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[76], "ACC_SEG1_TEMPS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[77], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[77], "ACC_SEG1_TEMPS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[78], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[78], "ACC_SEG1_TEMPS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[79], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[79], "ACC_SEG1_TEMPS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[80], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[80], "ACC_SEG2_VOLTS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[81], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[81], "ACC_SEG2_VOLTS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[82], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[82], "ACC_SEG2_VOLTS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[83], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[83], "ACC_SEG2_VOLTS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[84], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[84], "ACC_SEG2_VOLTS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[85], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[85], "ACC_SEG2_VOLTS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[86], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[86], "ACC_SEG2_TEMPS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[87], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[87], "ACC_SEG2_TEMPS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[88], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[88], "ACC_SEG2_TEMPS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[89], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[89], "ACC_SEG2_TEMPS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[90], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[90], "ACC_SEG2_TEMPS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[91], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[91], "ACC_SEG2_TEMPS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[92], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[92], "ACC_SEG3_VOLTS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[93], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[93], "ACC_SEG3_VOLTS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[94], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[94], "ACC_SEG3_VOLTS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[95], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[95], "ACC_SEG3_VOLTS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[96], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[96], "ACC_SEG3_VOLTS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[97], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[97], "ACC_SEG3_VOLTS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[98], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[98], "ACC_SEG3_TEMPS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[99], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[99], "ACC_SEG3_TEMPS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[100], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[100], "ACC_SEG3_TEMPS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[101], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[101], "ACC_SEG3_TEMPS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[102], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[102], "ACC_SEG3_TEMPS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[103], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[103], "ACC_SEG3_TEMPS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[104], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[104], "ACC_SEG4_VOLTS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[105], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[105], "ACC_SEG4_VOLTS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[106], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[106], "ACC_SEG4_VOLTS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[107], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[107], "ACC_SEG4_VOLTS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[108], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[108], "ACC_SEG4_VOLTS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[109], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[109], "ACC_SEG4_VOLTS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[110], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[110], "ACC_SEG4_TEMPS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[111], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[111], "ACC_SEG4_TEMPS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[112], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[112], "ACC_SEG4_TEMPS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[113], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[113], "ACC_SEG4_TEMPS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[114], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[114], "ACC_SEG4_TEMPS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[115], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[115], "ACC_SEG4_TEMPS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[116], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[116], "ACC_SEG5_VOLTS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[117], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[117], "ACC_SEG5_VOLTS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[118], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[118], "ACC_SEG5_VOLTS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[119], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[119], "ACC_SEG5_VOLTS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[120], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[120], "ACC_SEG5_VOLTS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[121], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[121], "ACC_SEG5_VOLTS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[122], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[122], "ACC_SEG5_TEMPS_CELL0");
    ArrowSchemaInitFromType(schema_root->children[123], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[123], "ACC_SEG5_TEMPS_CELL1");
    ArrowSchemaInitFromType(schema_root->children[124], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[124], "ACC_SEG5_TEMPS_CELL2");
    ArrowSchemaInitFromType(schema_root->children[125], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[125], "ACC_SEG5_TEMPS_CELL3");
    ArrowSchemaInitFromType(schema_root->children[126], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[126], "ACC_SEG5_TEMPS_CELL4");
    ArrowSchemaInitFromType(schema_root->children[127], NANOARROW_TYPE_INT8);
    ArrowSchemaSetName(schema_root->children[127], "ACC_SEG5_TEMPS_CELL5");
    ArrowSchemaInitFromType(schema_root->children[128], NANOARROW_TYPE_INT32);
    ArrowSchemaSetName(schema_root->children[128], "VDM_GPS_Latitude");
    ArrowSchemaInitFromType(schema_root->children[129], NANOARROW_TYPE_INT32);
    ArrowSchemaSetName(schema_root->children[129], "VDM_GPS_Longitude");
    ArrowSchemaInitFromType(schema_root->children[130], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[130], "VDM_GPS_SPEED");
    ArrowSchemaInitFromType(schema_root->children[131], NANOARROW_TYPE_INT16);
    ArrowSchemaSetName(schema_root->children[131], "VDM_GPS_ALTITUDE");
    ArrowSchemaInitFromType(schema_root->children[132], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[132], "VDM_GPS_TRUE_COURSE");
    ArrowSchemaInitFromType(schema_root->children[133], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[133], "VDM_GPS_SATELLITES_IN_USE");
    ArrowSchemaInitFromType(schema_root->children[134], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[134], "VDM_GPS_VALID1");
    ArrowSchemaInitFromType(schema_root->children[135], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[135], "VDM_GPS_VALID2");
    ArrowSchemaInitFromType(schema_root->children[136], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[136], "VDM_UTC_DATE_YEAR");
    ArrowSchemaInitFromType(schema_root->children[137], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[137], "VDM_UTC_DATE_MONTH");
    ArrowSchemaInitFromType(schema_root->children[138], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[138], "VDM_UTC_DATE_DAY");
    ArrowSchemaInitFromType(schema_root->children[139], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[139], "VDM_UTC_TIME_HOURS");
    ArrowSchemaInitFromType(schema_root->children[140], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[140], "VDM_UTC_TIME_MINUTES");
    ArrowSchemaInitFromType(schema_root->children[141], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[141], "VDM_UTC_TIME_SECONDS");
    ArrowSchemaInitFromType(schema_root->children[142], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[142], "VDM_X_AXIS_ACCELERATION");
    ArrowSchemaInitFromType(schema_root->children[143], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[143], "VDM_Y_AXIS_ACCELERATION");
    ArrowSchemaInitFromType(schema_root->children[144], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[144], "VDM_Z_AXIS_ACCELERATION");
    ArrowSchemaInitFromType(schema_root->children[145], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[145], "VDM_X_AXIS_YAW_RATE");
    ArrowSchemaInitFromType(schema_root->children[146], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[146], "VDM_Y_AXIS_YAW_RATE");
    ArrowSchemaInitFromType(schema_root->children[147], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[147], "VDM_Z_AXIS_YAW_RATE");
    ArrowSchemaInitFromType(schema_root->children[148], NANOARROW_TYPE_UINT16);
    ArrowSchemaSetName(schema_root->children[148], "ETC_STATUS_HE1");
    ArrowSchemaInitFromType(schema_root->children[149], NANOARROW_TYPE_UINT16);
    ArrowSchemaSetName(schema_root->children[149], "ETC_STATUS_HE2");
    ArrowSchemaInitFromType(schema_root->children[150], NANOARROW_TYPE_UINT16);
    ArrowSchemaSetName(schema_root->children[150], "ETC_STATUS_BRAKE_SENSE_VOLTAGE");
    ArrowSchemaInitFromType(schema_root->children[151], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[151], "ETC_STATUS_PEDAL_TRAVEL");
    ArrowSchemaInitFromType(schema_root->children[152], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[152], "ETC_STATUS_RTD_BUTTON");
    ArrowSchemaInitFromType(schema_root->children[153], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[153], "ETC_STATUS_RTDS");
    ArrowSchemaInitFromType(schema_root->children[154], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[154], "ETC_STATUS_REVERSE");
    ArrowSchemaInitFromType(schema_root->children[155], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[155], "ETC_STATUS_BRAKELIGHT");
    ArrowSchemaInitFromType(schema_root->children[156], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[156], "ETC_STATUS_RTD");
    ArrowSchemaInitFromType(schema_root->children[157], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[157], "ETC_STATUS_IMPLAUSIBILITY");
    ArrowSchemaInitFromType(schema_root->children[158], NANOARROW_TYPE_BOOL);
    ArrowSchemaSetName(schema_root->children[158], "ETC_STATUS_TS_ACTIVE");
    ArrowSchemaInitFromType(schema_root->children[159], NANOARROW_TYPE_UINT16);
    ArrowSchemaSetName(schema_root->children[159], "PDB_POWER_A_GLV_VOLTAGE");
    ArrowSchemaInitFromType(schema_root->children[160], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[160], "PDB_POWER_A_CURRENT_SHUTDOWN");
    ArrowSchemaInitFromType(schema_root->children[161], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[161], "PDB_POWER_A_CURRENT_ACC");
    ArrowSchemaInitFromType(schema_root->children[162], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[162], "PDB_POWER_A_CURRENT_ETC");
    ArrowSchemaInitFromType(schema_root->children[163], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[163], "PDB_POWER_A_CURRENT_BPS");
    ArrowSchemaInitFromType(schema_root->children[164], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[164], "PDB_POWER_A_CURRENT_TRACTIVE");
    ArrowSchemaInitFromType(schema_root->children[165], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[165], "PDB_POWER_A_CURRENT_BSPD");
    ArrowSchemaInitFromType(schema_root->children[166], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[166], "PDB_POWER_B_CURRENT_TELEMETRY");
    ArrowSchemaInitFromType(schema_root->children[167], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[167], "PDB_POWER_B_CURRENT_PDB");
    ArrowSchemaInitFromType(schema_root->children[168], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[168], "PDB_POWER_B_CURRENT_DASH");
    ArrowSchemaInitFromType(schema_root->children[169], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[169], "PDB_POWER_B_CURRENT_RTML");
    ArrowSchemaInitFromType(schema_root->children[170], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[170], "PDB_POWER_B_CURRENT_EXTRA_1");
    ArrowSchemaInitFromType(schema_root->children[171], NANOARROW_TYPE_HALF_FLOAT);
    ArrowSchemaSetName(schema_root->children[171], "PDB_POWER_B_CURRENT_EXTRA_2");
    ArrowSchemaInitFromType(schema_root->children[172], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[172], "TMAIN_DATA_BRAKES_F");
    ArrowSchemaInitFromType(schema_root->children[173], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[173], "TMAIN_DATA_BRAKES_R");
    ArrowSchemaInitFromType(schema_root->children[174], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[174], "TPERIPH_FL_DATA_WHEELSPEED");
    ArrowSchemaInitFromType(schema_root->children[175], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[175], "TPERIPH_FL_DATA_SUSTRAVEL");
    ArrowSchemaInitFromType(schema_root->children[176], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[176], "TPERIPH_FL_DATA_STRAIN");
    ArrowSchemaInitFromType(schema_root->children[177], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[177], "TPERIPH_FL_DATA_SIDE_TIRE_TEMP");
    ArrowSchemaInitFromType(schema_root->children[178], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[178], "TPERIPH_FR_DATA_WHEELSPEED");
    ArrowSchemaInitFromType(schema_root->children[179], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[179], "TPERIPH_FR_DATA_SUSTRAVEL");
    ArrowSchemaInitFromType(schema_root->children[180], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[180], "TPERIPH_FR_DATA_STRAIN");
    ArrowSchemaInitFromType(schema_root->children[181], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[181], "TPERIPH_FR_DATA_SIDE_TIRE_TEMP");
    ArrowSchemaInitFromType(schema_root->children[182], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[182], "TPERIPH_BL_DATA_WHEELSPEED");
    ArrowSchemaInitFromType(schema_root->children[183], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[183], "TPERIPH_BL_DATA_SUSTRAVEL");
    ArrowSchemaInitFromType(schema_root->children[184], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[184], "TPERIPH_BL_DATA_STRAIN");
    ArrowSchemaInitFromType(schema_root->children[185], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[185], "TPERIPH_BL_DATA_SIDE_TIRE_TEMP");
    ArrowSchemaInitFromType(schema_root->children[186], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[186], "TPERIPH_BR_DATA_WHEELSPEED");
    ArrowSchemaInitFromType(schema_root->children[187], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[187], "TPERIPH_BR_DATA_SUSTRAVEL");
    ArrowSchemaInitFromType(schema_root->children[188], NANOARROW_TYPE_FLOAT);
    ArrowSchemaSetName(schema_root->children[188], "TPERIPH_BR_DATA_STRAIN");
    ArrowSchemaInitFromType(schema_root->children[189], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[189], "TPERIPH_BR_DATA_SIDE_TIRE_TEMP");
    ArrowSchemaInitFromType(schema_root->children[190], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[190], "TPERIPH_FL_TIRETEMP_1");
    ArrowSchemaInitFromType(schema_root->children[191], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[191], "TPERIPH_FL_TIRETEMP_2");
    ArrowSchemaInitFromType(schema_root->children[192], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[192], "TPERIPH_FL_TIRETEMP_3");
    ArrowSchemaInitFromType(schema_root->children[193], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[193], "TPERIPH_FL_TIRETEMP_4");
    ArrowSchemaInitFromType(schema_root->children[194], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[194], "TPERIPH_FL_TIRETEMP_5");
    ArrowSchemaInitFromType(schema_root->children[195], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[195], "TPERIPH_FL_TIRETEMP_6");
    ArrowSchemaInitFromType(schema_root->children[196], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[196], "TPERIPH_FL_TIRETEMP_7");
    ArrowSchemaInitFromType(schema_root->children[197], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[197], "TPERIPH_FL_TIRETEMP_8");
    ArrowSchemaInitFromType(schema_root->children[198], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[198], "TPERIPH_FR_TIRETEMP_1");
    ArrowSchemaInitFromType(schema_root->children[199], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[199], "TPERIPH_FR_TIRETEMP_2");
    ArrowSchemaInitFromType(schema_root->children[200], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[200], "TPERIPH_FR_TIRETEMP_3");
    ArrowSchemaInitFromType(schema_root->children[201], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[201], "TPERIPH_FR_TIRETEMP_4");
    ArrowSchemaInitFromType(schema_root->children[202], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[202], "TPERIPH_FR_TIRETEMP_5");
    ArrowSchemaInitFromType(schema_root->children[203], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[203], "TPERIPH_FR_TIRETEMP_6");
    ArrowSchemaInitFromType(schema_root->children[204], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[204], "TPERIPH_FR_TIRETEMP_7");
    ArrowSchemaInitFromType(schema_root->children[205], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[205], "TPERIPH_FR_TIRETEMP_8");
    ArrowSchemaInitFromType(schema_root->children[206], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[206], "TPERIPH_BL_TIRETEMP_1");
    ArrowSchemaInitFromType(schema_root->children[207], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[207], "TPERIPH_BL_TIRETEMP_2");
    ArrowSchemaInitFromType(schema_root->children[208], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[208], "TPERIPH_BL_TIRETEMP_3");
    ArrowSchemaInitFromType(schema_root->children[209], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[209], "TPERIPH_BL_TIRETEMP_4");
    ArrowSchemaInitFromType(schema_root->children[210], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[210], "TPERIPH_BL_TIRETEMP_5");
    ArrowSchemaInitFromType(schema_root->children[211], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[211], "TPERIPH_BL_TIRETEMP_6");
    ArrowSchemaInitFromType(schema_root->children[212], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[212], "TPERIPH_BL_TIRETEMP_7");
    ArrowSchemaInitFromType(schema_root->children[213], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[213], "TPERIPH_BL_TIRETEMP_8");
    ArrowSchemaInitFromType(schema_root->children[214], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[214], "TPERIPH_BR_TIRETEMP_1");
    ArrowSchemaInitFromType(schema_root->children[215], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[215], "TPERIPH_BR_TIRETEMP_2");
    ArrowSchemaInitFromType(schema_root->children[216], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[216], "TPERIPH_BR_TIRETEMP_3");
    ArrowSchemaInitFromType(schema_root->children[217], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[217], "TPERIPH_BR_TIRETEMP_4");
    ArrowSchemaInitFromType(schema_root->children[218], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[218], "TPERIPH_BR_TIRETEMP_5");
    ArrowSchemaInitFromType(schema_root->children[219], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[219], "TPERIPH_BR_TIRETEMP_6");
    ArrowSchemaInitFromType(schema_root->children[220], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[220], "TPERIPH_BR_TIRETEMP_7");
    ArrowSchemaInitFromType(schema_root->children[221], NANOARROW_TYPE_UINT8);
    ArrowSchemaSetName(schema_root->children[221], "TPERIPH_BR_TIRETEMP_8");
    return schema_root;
}
na::UniqueArray make_nanoarrow_array(ArrowSchema *schema_root, int batch_rows) {
    ArrowError error;

    na::UniqueArray array_root;
    ARROW_ERROR_PRINT(ArrowArrayInitFromSchema(array_root.get(), schema_root, &error));
    ArrowArrayAllocateChildren(array_root.get(), 222);
    for (int i = 0; i < 222; i++) {
        ARROW_ERROR_PRINT(ArrowArrayInitFromSchema(array_root->children[i], schema_root->children[i], &error));
        // ArrowArrayStartAppending(array_root->children[i]);
        ArrowArrayReserve(array_root->children[i], batch_rows);
        // ARROW_ERROR_PRINT(ArrowArrayFinishBuildingDefault(array_root->children[i], &error));
    }
    return array_root;
}
